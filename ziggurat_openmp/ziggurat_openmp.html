<html>

  <head>
    <title>
      ZIGGURAT_OPENMP - Using the ZIGGURAT Library with OpenMP
    </title>
  </head>

  <body bgcolor="#EEEEEE" link="#CC0000" alink="#FF3300" vlink="#000055">

    <h1 align = "center">
      ZIGGURAT_OPENMP <br> Using the ZIGGURAT Library with OpenMP
    </h1>

    <hr>

    <p>
      <b>ZIGGURAT_OPENMP</b>,
      a C++ code which 
      explores how the ZIGGURAT library may be used, in conjunction with
      OpenMP, to compute random numbers efficiently and correctly.
    </p>

    <p>
      The primary worry, when computing random numbers in OpenMP, 
      occurs when the user calls a random number generator which may
      have some internal memory.  In that case, the internal memory
      may become corrupted if multiple threads are invoking the code
      at the same time.  
    </p>

    <p>
      A safe way to compute random numbers is to ensure that the
      seed value, and any other data or tables needed by the computation,
      are stored externally, in the user program.  That way, each thread
      can have a separate copy of the data, and multiple threads of random number
      calculations can be going along simultaneously without fear
      of overwriting or memory contention.
    </p>

    <p>
      The program presented here is somewhat awkward, because it wishes
      to verify that OpenMP can compute exactly the same data as a sequential
      program.  To do so, we need to create separate seeds for each threads,
      and ensure that the threads execute the loop iterations in some predictable
      sequence.  When the sequential program goes through the same calculations,
      we again have to do some acrobatics to ensure that it is doing the
      same things that the parallel program did.
    </p>

    <p>
      So some of the complications in this program are there to ensure that
      we can exhibit the same results sequentially and in parallel.  Once
      you are convinced of that, and see how to go about this, your own
      program can be set up without some of the overhead and special
      instructions used in this demonstration.
    </p>

    <p>
      On an Apple PowerPC G5 with two processors, the following results were
      observed:
      <table border="1" align="center">
        <tr>
          <th>Threads</th><th>Test01</th><th>Test02</th><th>Test03</th><th>Test04</th>
        </tr>
        <tr>
          <td>1</td><td>0.521 s</td><td>2.342 s</td><td>1.175 s</td><td>1.223 s</td>
        </tr>
        <tr>
          <td>2</td><td>0.226 s</td><td>1.202 s</td><td>0.595 s</td><td>0.615 s</td>
        </tr>
        <tr>
          <td>4</td><td>0.225 s</td><td>1.187 s</td><td>0.592 s</td><td>0.614 s</td>
        </tr>
      </table> 
    </p>

    <h3 align = "center">
      Usage:
    </h3>

    <p>
      In the BASH shell, the program could be run with 2 threads using the commands:
      <pre>
        export OMP_NUM_THREADS=2
        ./ziggurat_openmp
      </pre>
    </p>

    <h3 align = "center">
      Licensing:
    </h3>

    <p>
      The computer code and data files described and made available on this web page 
      are distributed under
      <a href = "https://www.gnu.org/licenses/lgpl-3.0.en.html">the GNU LGPL license.</a>
    </p>

    <h3 align = "center">
      Languages:
    </h3>

    <p>
      <b>ZIGGURAT_OPENMP</b> is available in
      <a href = "../../c_src/ziggurat_openmp/ziggurat_openmp.html">a C version</a> and
      <a href = "../../cpp_src/ziggurat_openmp/ziggurat_openmp.html">a C++ version</a> and
      <a href = "../../f_src/ziggurat_openmp/ziggurat_openmp.html">a FORTRAN90 version</a>.
    </p>

    <h3 align = "center">
      Related Data and Programs:
    </h3>

    <p>
      <a href = "../../cpp_src/dijkstra_openmp/dijkstra_openmp.html">
      DIJKSTRA_OPENMP</a>,
      a C++ code which
      uses OpenMP to parallelize a simple example of Dijkstra's 
      minimum distance algorithm for graphs.
    </p>

    <p>
      <a href = "../../cpp_src/fft_openmp/fft_openmp.html">
      FFT_OPENMP</a>,
      a C++ code which
      demonstrates the computation of a Fast Fourier Transform
      in parallel, using OpenMP.
    </p>

    <p>
      <a href = "../../cpp_src/heated_plate_openmp/heated_plate_openmp.html">
      HEATED_PLATE_OPENMP</a>,
      a C++ code which 
      solves the steady (time independent) heat equation in a 2D
      rectangular region, using OpenMP to run in parallel.
    </p>

    <p>
      <a href = "../../cpp_src/hello_openmp/hello_openmp.html">
      HELLO_OPENMP</a>,
      a C++ code which 
      prints out "Hello, world!" using the OpenMP parallel programming environment. 
    </p>

    <p>
      <a href = "../../cpp_src/jacobi_openmp/jacobi_openmp.html">
      JACOBI_OPENMP</a>,
      a C++ code which
      illustrates the use of the OpenMP application program interface
      to parallelize a Jacobi iteration solving A*x=b.
    </p>

    <p>
      <a href = "../../cpp_src/md_openmp/md_openmp.html">
      MD_OPENMP</a>,
      a C++ code which
      carries out a molecular dynamics simulation using OpenMP.
    <p>

    <p>
      <a href = "../../cpp_src/multitask_openmp/multitask_openmp.html">
      MULTITASK_OPENMP</a>,
      a C++ code which
      demonstrates how to "multitask", that is, to execute several unrelated
      and distinct tasks simultaneously, using OpenMP for parallel execution.
    </p>

    <p>
      <a href = "../../cpp_src/mxm_openmp/mxm_openmp.html">
      MXM_OPENMP</a>,
      a C++ code which
      computes a dense matrix product C=A*B,
      using OpenMP for parallel execution.
    <p>

    <p>
      <a href = "../../cpp_src/openmp_test/openmp_test.html">
      openmp_test</a>,
      C++ codes which
      illustrate the use of the OpenMP application program interface
      for carrying out parallel computations in a shared memory environment.
    </p>

    <p>
      <a href = "../../cpp_src/poisson_openmp/poisson_openmp.html">
      POISSON_OPENMP</a>,
      a C++ code which
      computes an approximate solution to the Poisson equation in a rectangle,
      using the Jacobi iteration to solve the linear system, and OpenMP to
      carry out the Jacobi iteration in parallel.
    </p>

    <p>
      <a href = "../../cpp_src/prime_openmp/prime_openmp.html">
      PRIME_OPENMP</a>,
      a C++ code which 
      counts the number of primes between 1 and N, using OpenMP for parallel execution.
    </p>

    <p>
      <a href = "../../cpp_src/quad_openmp/quad_openmp.html">
      QUAD_OPENMP</a>,
      a C++ code which
      approximates an integral using a quadrature rule, and carries out the
      computation in parallel using OpenMP.
    </p>

    <p>
      <a href = "../../cpp_src/random_openmp/random_openmp.html">
      RANDOM_OPENMP</a>,
      a C++ code which
      illustrates how a parallel program using OpenMP can generate multiple
      distinct streams of random numbers.
    </p>

    <p>
      <a href = "../../cpp_src/satisfy_openmp/satisfy_openmp.html">
      SATISFY_OPENMP</a>,
      a C++ code which
      demonstrates, for a particular circuit, an exhaustive search
      for solutions of the circuit satisfy problem,
      using OpenMP for parallel execution.
    <p>

    <p>
      <a href = "../../cpp_src/schedule_openmp/schedule_openmp.html">
      SCHEDULE_OPENMP</a>,
      a C++ code which
      demonstrates the default, static, and dynamic methods of "scheduling"
      loop iterations in OpenMP to avoid work imbalance.
    <p>

    <p>
      <a href = "../../cpp_src/sgefa_openmp/sgefa_openmp.html">
      SGEFA_OPENMP</a>,
      a C++ code which 
      reimplements the SGEFA/SGESL linear algebra routines from
      LINPACK for use with OpenMP.
    </p>

    <p>
      <a href = "../../cpp_src/ziggurat/ziggurat.html">
      ZIGGURAT</a>, 
      a C++ code which
      generates points from a uniform, normal or exponential distribution, using
      the ziggurat method.
    </p>

    <p>
      <a href = "../../cpp_src/ziggurat_openmp_test/ziggurat_openmp_test.html">
      ziggurat_openmp_test</a>
    </p>

    <h3 align = "center">
      Reference:
    </h3>

    <p>
      <ol>
        <li>
          Philip Leong, Guanglie Zhang, Dong-U Lee, Wayne Luk, John Villasenor,<br>
          A comment on the implementation of the ziggurat method,<br>
          Journal of Statistical Software,<br>
          Volume 12, Number 7, February 2005.
        </li>
        <li>
          George Marsaglia, Wai Wan Tsang,<br>
          The Ziggurat Method for Generating Random Variables,<br>
          Journal of Statistical Software,<br>
          Volume 5, Number 8, October 2000, seven pages.
        </li>
      </ol>
    </p>

    <h3 align = "center">
      Source Code:
    </h3>

    <p>
      <ul>
        <li>
          <a href = "ziggurat_openmp.cpp">ziggurat_openmp.cpp</a>, the source code.
        </li>
        <li>
          <a href = "ziggurat_openmp.sh">ziggurat_openmp.sh</a>, 
          compiles the source code.
        </li>
      </ul>
    </p>

    <hr>

    <i>
      Last revised on 04 March 2020.
    </i>

    <!-- John Burkardt -->

  </body>

  <!-- Initial HTML skeleton created by HTMLINDEX. -->

</html>
