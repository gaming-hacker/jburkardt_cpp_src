<html>

  <head>
    <title>
      TET_MESH_REFINE - Simple Refinement of a Tet Mesh
    </title>
  </head>

  <body bgcolor="#EEEEEE" link="#CC0000" alink="#FF3300" vlink="#000055">

    <h1 align = "center">
      TET_MESH_REFINE <br> Simple Refinement of a Tet Mesh
    </h1>

    <hr>

    <p>
      <b>TET_MESH_REFINE</b>,
      a C++ code which
      refines every tetrahedron
      in a tet mesh, replacing each tetrahedron by 8 subtetrahedrons.
    </p>

    <p>
      In particular, TET_MESH_REFINE reads two files,
      one listing the coordinates of nodes, the other the indices
      of nodes forming tetrahedrons.  From this information, it
      determines a refinement of the mesh, and writes out new
      node and tetrahedron files corresponding to this refinement.
    </p>

    <p>
      The refinement of a single tetrahedron is easy.  Every pair
      of nodes generates a new node whose location is the average of
      the locations of the original two nodes.  The problem is that
      many tetrahedrons may share the same edge.  The new node needs
      to be generated exactly once, and assigned a unique index, which
      all the tetrahedrons will share.  The tricky part of this calculation
      is thus figuring out whether it is time to generate a new node, or
      whether the node has already been generated, in which case the
      appropriate index must be retrieved.
    </p>

    <p>
      The current version of the code can only refine a tet mesh
      of order 4.  There's no real reason why it could not also
      handle meshes of order 10, except that the programming is
      a bit more complex.  For the moment, a mesh of order 10
      could be handled by using the sequence of programs:
      <pre><b>
        TET_MESH_Q2L --&gt; TET_MESH_REFINE --&gt; TET_MESH_L2Q
      </b></pre>
    </p>

    <h3 align = "center">
      Usage:
    </h3>

    <p>
      <blockquote>
        <b>tet_mesh_refine</b> <i>prefix</i>
      </blockquote>
      where <i>prefix</i> is the common file prefix:
      <ul>
        <li>
          <i>prefix</i><b>_nodes.txt</b>,    the node coordinates;
        </li>
        <li>
          <i>prefix</i><b>_elements.txt</b>,    the element definitions.
        </li>
        <li>
          <i>prefix</i><b>_ref_nodes.txt</b>,    the refined node coordinates;
        </li>
        <li>
          <i>prefix</i><b>_ref_elements.txt</b>,    the refined element definitions.
        </li>
      </ul>
    </p>

    <p>
      The element definition file will list node indices.  In C++, it may be
      more natural to use 0-based indices.  This program will accept an element
      definition file that is 0-based or 1-based, and will convert a 1-based
      input file so that it becomes 0-based internal to the program.  The detection
      of 1-based data is determined by the absence of the use of a 0 index, and
      the use of an index equal to the number of nodes.  This is an implicit
      and fallible, but reasonable, way to handle this problem.
    </p>

    <p>
      The input and output files use the simple
      <a href = "../../data/table/table.html">TABLE format</a>;
      comment lines begin with a "#" character.  Otherwise, each line
      of the file contains one set of information, either the coordinates
      of a node (for a node file), or the indices of nodes that make up
      a tetrahedron, (for a tetrahedron file).
    </p>

    <p>
      The input file <i>nodes.txt</i> contains the coordinate information
      for the tet mesh.  Each data line contains the X and
      Y coordinates of a single node.
    </p>

    <p>
      The input file <i>tetras.txt</i> contains the tetrahedron information
      for the tet mesh.  Each data line contains the indices
      of the nodes that form a tetrahedron.
    </p>

    <p>
      The output files have the same format.
    </p>

    <h3 align = "center">
      Licensing:
    </h3>

    <p>
      The computer code and data files described and made available on this web page
      are distributed under
      <a href = "https://www.gnu.org/licenses/lgpl-3.0.en.html">the GNU LGPL license.</a>
    </p>

    <h3 align = "center">
      Languages:
    </h3>

    <p>
      <b>TET_MESH_REFINE</b> is available in
      <a href = "../../cpp_src/tet_mesh_refine/tet_mesh_refine.html">a C++ version</a> and
      <a href = "../../f_src/tet_mesh_refine/tet_mesh_refine.html">a FORTRAN90 version</a> and
      <a href = "../../m_src/tet_mesh_refine/tet_mesh_refine.html">a MATLAB version</a>.
    </p>

    <h3 align = "center">
      Related Programs:
    </h3>

    <p>
      <a href = "../../cpp_src/tet_mesh/tet_mesh.html">
      TET_MESH</a>,
      a C++ library which
      includes a variety of routines for working
      with tetrahedral meshes.
    </p>

    <p>
      <a href = "../../cpp_src/tet_mesh_boundary/tet_mesh_boundary.html">
      TET_MESH_BOUNDARY</a>,
      a C++ program which
      returns the nodes and faces of the boundary of a tetrahedral mesh,
      which themselves form a 3D triangular mesh or "TRI_SURFACE".
    </p>

    <p>
      <a href = "../../cpp_src/tet_mesh_display_opengl/tet_mesh_display_opengl.html">
      TET_MESH_DISPLAY_OPENGL</a>,
      a C++ program which
      reads a tet mesh and displays the
      nodes and edges using OpenGL.
    </p>

    <p>
      <a href = "../../cpp_src/tet_mesh_l2q/tet_mesh_l2q.html">
      TET_MESH_L2Q</a>,
      a C++ program which
      takes a 4-node tet mesh
      and makes a 10-node tet mesh by adding nodes.
    </p>

    <p>
      <a href = "../../data/tet_mesh/tet_mesh.html">
      TET_MESH_ORDER4</a>,
      a directory which
      contains a description and
      examples of a tet mesh using order 4 elements.
    </p>

    <p>
      <a href = "../../data/tet_mesh_order10/tet_mesh_order10.html">
      TET_MESH_ORDER10</a>,
      a directory which
      contains a description and
      examples of a tet mesh using order 10 elements.
    </p>

    <p>
      <a href = "../../cpp_src/tet_mesh_q2l/tet_mesh_q2l.html">
      TET_MESH_Q2L</a>,
      a C++ program which
      takes a 10-node tet mesh and makes
      a 4-node tet mesh.
    </p>

    <p>
      <a href = "../../cpp_src/tet_mesh_quality/tet_mesh_quality.html">
      TET_MESH_QUALITY</a>,
      a C++ program which
      takes a 4-node tet mesh and computes
      the "quality" of the mesh.
    </p>

    <p>
      <a href = "../../cpp_src/tet_mesh_rcm/tet_mesh_rcm.html">
      TET_MESH_RCM</a>,
      a C++ program which
      takes a tet mesh and
      relabels the nodes to reduce the bandwidth of the
      corresponding adjacency matrix.
    </p>

    <p>
      <a href = "../../cpp_src/tet_mesh_refine_test/tet_mesh_refine_test.html">
      tet_mesh_refine_test</a>
    </p>

    <p>
      <a href = "../../cpp_src/tet_mesh_tet_neighbors/tet_mesh_tet_neighbors.html">
      TET_MESH_TET_NEIGHBORS</a>,
      a C++ program which
      computes the tetrahedral adjacency information.
    </p>

    <p>
      <a href = "../../cpp_src/tet_mesh_volumes/tet_mesh_volumes.html">
      TET_MESH_VOLUMES</a>,
      a C++ program which
      computes the volume of each tetrahedron in a tet mesh;
    </p>

    <h3 align = "center">
      Reference:
    </h3>

    <p>
      <ol>
        <li>
          Herbert Edelsbrunner,<br>
          Geometry and Topology for Mesh Generation,<br>
          Cambridge, 2001,<br>
          ISBN: 0-521-79309-2,<br>
          LC: QA377.E36.
        </li>
        <li>
          Barry Joe,<br>
          GEOMPACK - a software package for the generation of meshes
          using geometric algorithms,<br>
          Advances in Engineering Software,<br>
          Volume 13, Number 5, 1991, pages 325-331.
        </li>
        <li>
          Anwei Liu, Barry Joe,<br>
          Quality Local Refinement of Tetrahedral Meshes Based
          on 8-Subtetrahedron Subdivision,<br>
          Mathematics of Computation,<br>
          Volume 65, Number 215, July 1996, pages 1183-1200.
        </li>
        <li>
          Per-Olof Persson, Gilbert Strang,<br>
          A Simple Mesh Generator in MATLAB,<br>
          SIAM Review,<br>
          Volume 46, Number 2, June 2004, pages 329-345.
        </li>
      </ol>
    </p>

    <h3 align = "center">
      Source Code:
    </h3>

    <p>
      <ul>
        <li>
          <a href = "tet_mesh_refine.cpp">tet_mesh_refine.cpp</a>,
          the source code.
        </li>
        <li>
          <a href = "tet_mesh_refine.sh">tet_mesh_refine.sh</a>,
          the source code.
        </li>
      </ul>
    </p>

    <hr>

    <i>
      Last revised on 29 April 2020.
    </i>

    <!-- John Burkardt -->

  </body>

  <!-- Initial HTML skeleton created by HTMLINDEX. -->

</html>
